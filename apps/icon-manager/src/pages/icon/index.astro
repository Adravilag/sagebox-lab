---
import Layout from '../../layouts/Layout.astro';
import { getLocale, createT, type Locale } from '../../lib/i18n';

const locale = getLocale(Astro.request) as Locale;
const t = createT(locale);

// Popular search suggestions
const suggestions = [
  'check', 'arrow', 'user', 'home', 'settings', 
  'search', 'menu', 'close', 'edit', 'delete',
  'file', 'folder', 'star', 'heart', 'mail',
  'calendar', 'clock', 'notification', 'download', 'upload'
];
---

<Layout title="Search Icons - Icon Manager">
  <div class="search-page">
    <header class="search-header">
      <div class="search-header-content">
        <a href="/" class="back-btn" title="Back to Icon Manager">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
        </a>
        <div class="search-title">
          <h1>Search Icons</h1>
          <p class="search-subtitle">Find and add icons from Iconify to your project</p>
        </div>
      </div>
      
      <div class="search-container">
        <div class="search-mode-toggle">
          <a href="/" class="mode-btn" title={t('header.search.local')}>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
              <polyline points="9,22 9,12 15,12 15,22"></polyline>
            </svg>
            <span>{t('header.search.local')}</span>
          </a>
          <button class="mode-btn active" data-mode="online" title={t('header.search.online')}>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="2" y1="12" x2="22" y2="12"></line>
              <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
            </svg>
            <span>{t('header.search.online')}</span>
          </button>
        </div>
        <div class="search-box">
          <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="M21 21l-4.35-4.35"/>
          </svg>
          <input 
            type="text" 
            id="search-input" 
            placeholder="Search icons... (e.g., check, arrow, user)"
            autofocus
          />
          <span class="search-hint">Press Enter to search</span>
        </div>
      </div>
    </header>

    <main class="search-main">
      <div class="suggestions">
        <h3>Popular searches</h3>
        <div class="suggestion-grid">
          {suggestions.map(term => (
            <a href={`/icon/${term}`} class="suggestion-chip">{term}</a>
          ))}
        </div>
      </div>

      <div class="info-box">
        <div class="info-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 16v-4M12 8h.01"/>
          </svg>
        </div>
        <div class="info-content">
          <h4>How it works</h4>
          <ul>
            <li>Search for any icon by name (e.g., "check", "arrow-right")</li>
            <li>Browse results from 150+ icon sets on Iconify</li>
            <li>Select icons and click "Add to Library" to import them</li>
            <li>Use icons in your project with the <code>sg-icon</code> component</li>
          </ul>
        </div>
      </div>
    </main>
  </div>
</Layout>

<script>
  const searchInput = document.getElementById('search-input') as HTMLInputElement;

  searchInput?.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' && searchInput.value.trim()) {
      window.location.href = `/icon/${encodeURIComponent(searchInput.value.trim())}`;
    }
  });
</script>

<style>
  .search-page {
    min-height: 100vh;
    background: var(--bg);
    color: var(--text);
    font-family: var(--font-sans);
  }

  .search-header {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(9, 9, 11, 0.9);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--border);
    padding: 1rem 1.5rem;
  }

  .search-header-content {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
  }

  .back-btn {
    width: 40px;
    height: 40px;
    border-radius: 10px;
    background: var(--surface);
    border: 1px solid var(--border);
    color: var(--text-muted);
    display: flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    transition: 150ms ease;
  }

  .back-btn:hover {
    background: var(--surface-elevated);
    color: var(--text);
    border-color: var(--border-hover);
  }

  .search-title h1 {
    font-size: 1.25rem;
    font-weight: 600;
    margin: 0;
  }

  .search-subtitle {
    font-size: 0.875rem;
    color: var(--text-muted);
    margin: 0.25rem 0 0 0;
  }

  .search-container {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .search-mode-toggle {
    display: flex;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 3px;
    gap: 2px;
  }

  .mode-btn {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.5rem 0.75rem;
    border: none;
    background: transparent;
    color: var(--text-muted);
    font-size: 0.8125rem;
    font-weight: 500;
    border-radius: 5px;
    cursor: pointer;
    transition: all 150ms ease;
    white-space: nowrap;
    text-decoration: none;
  }

  .mode-btn:hover {
    color: var(--text);
    background: rgba(255, 255, 255, 0.05);
  }

  .mode-btn.active {
    background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.15));
    color: #818cf8;
  }

  .mode-btn svg {
    flex-shrink: 0;
  }

  .search-box {
    flex: 1;
    position: relative;
    display: flex;
    align-items: center;
  }

  .search-icon {
    position: absolute;
    left: 1rem;
    color: var(--text-subtle);
    pointer-events: none;
  }

  #search-input {
    width: 100%;
    padding: 0.875rem 1rem 0.875rem 3rem;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    color: var(--text);
    font-size: 1rem;
    font-family: inherit;
    transition: 150ms ease;
  }

  #search-input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
  }

  #search-input::placeholder {
    color: var(--text-subtle);
  }

  .search-hint {
    position: absolute;
    right: 1rem;
    font-size: 0.75rem;
    color: var(--text-subtle);
    background: var(--surface-elevated);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
  }

  .search-main {
    padding: 2rem 1.5rem;
    max-width: 800px;
    margin: 0 auto;
  }

  .suggestions {
    margin-bottom: 2.5rem;
  }

  .suggestions h3 {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 1rem;
  }

  .suggestion-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .suggestion-chip {
    display: inline-flex;
    align-items: center;
    padding: 0.5rem 1rem;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 20px;
    color: var(--text-muted);
    font-size: 0.875rem;
    text-decoration: none;
    transition: 150ms ease;
  }

  .suggestion-chip:hover {
    background: var(--surface-elevated);
    border-color: var(--border-hover);
    color: var(--text);
  }

  .info-box {
    display: flex;
    gap: 1rem;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 1.5rem;
  }

  .info-icon {
    flex-shrink: 0;
    width: 40px;
    height: 40px;
    background: rgba(99, 102, 241, 0.1);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--accent);
  }

  .info-content h4 {
    font-size: 1rem;
    font-weight: 600;
    margin: 0 0 0.75rem 0;
  }

  .info-content ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .info-content li {
    position: relative;
    padding-left: 1.25rem;
    margin-bottom: 0.5rem;
    font-size: 0.875rem;
    color: var(--text-muted);
  }

  .info-content li::before {
    content: 'â†’';
    position: absolute;
    left: 0;
    color: var(--text-subtle);
  }

  .info-content li:last-child {
    margin-bottom: 0;
  }

  .info-content code {
    background: var(--bg);
    padding: 0.125rem 0.375rem;
    border-radius: 4px;
    font-size: 0.8125rem;
    color: var(--accent);
  }

  @media (max-width: 640px) {
    .search-hint {
      display: none;
    }

    .info-box {
      flex-direction: column;
    }
  }
</style>
